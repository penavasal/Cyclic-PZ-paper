\documentclass[preprint,12pt,a4paper]{elsarticle}

\usepackage{lineno,hyperref}
\usepackage{float}
\usepackage{subfig}
\usepackage{color}
\usepackage{soul}

\usepackage{algcompatible}
\usepackage{algorithm}

\usepackage{cancel}

\usepackage{amsmath,amsthm,amssymb}

\modulolinenumbers[5]

\journal{Computers and Geotechnics}

%%%%%%%%%%%%%%%%%%%%%%%
%% Elsevier bibliography styles
%%%%%%%%%%%%%%%%%%%%%%%
%% To change the style, put a % in front of the second line of the current style and
%% remove the % from the second line of the style you would like to use.
%%%%%%%%%%%%%%%%%%%%%%%

%% Numbered
%\bibliographystyle{model1-num-names}

%% Numbered without titles
%\bibliographystyle{model1a-num-names}

%% Harvard
%\bibliographystyle{model2-names.bst}\biboptions{authoryear}

%% Vancouver numbered
%\usepackage{numcompress}\bibliographystyle{model3-num-names}

%% Vancouver name/year
%\usepackage{numcompress}\bibliographystyle{model4-names}\biboptions{authoryear}

%% APA style
%\bibliographystyle{model5-names}\biboptions{authoryear}

%% AMA style
%\usepackage{numcompress}\bibliographystyle{model6-num-names}

%% `Elsevier LaTeX' style
\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{frontmatter}

\title{Meshfree modeling of cyclic behavior of sands within large strain Generalized Plasticity Framework}

%% Group authors per affiliation:
\author{
Pedro Navas$^a$\footnote{Corresponding author: pedro.navas@upm.es},
Diego Manzanal$^a$,
Miguel Mart\'in-Stickle$^{a}$,
and  Manuel Pastor$^a$
 }
 \address{
 $^a$ ETSI Caminos, Canales y Puertos, Universidad Polit\'ectnica de Madrid.\\ c. Prof. Aranguren 3, 28040 Madrid, Spain
}

\begin{abstract}

In this publication the $u-w$ finite strain formulation is enhanced with a Generalized Plasticity model for sands. The new model is numerically solved using an optimal transportation meshfree approach that is best suited for numerical analysis at finite strains. This new model allows to capture the hydro-mechanical response under large deformations of a saturated sand like soils where acceleration of water with respect the solid skeleton is not negligible. To the authors' knowledge, no attempt has been previously devoted to include in the $u-w$ finite strain approach an elastoplastic behaviour from the Generalized Plasticity theory. In order to assess the validity of the proposed model, several tests are performed: an undrained triaxial test under monotonic loading, a triaxial consolidation test under monotonic loading with drained conditions and a cyclic triaxial test with undrained and drained conditions. The observed results are qualitatively correct and in agreement with numerical solutions previously obtained by other researchers.
\end{abstract}

\begin{keyword}
Generalized Plasticity \sep $u-w$ formulation \sep Optimal Transportation Meshfree \sep Soil Dynamics \sep Cyclic
\end{keyword}

\end{frontmatter}

\linenumbers

\section{Introduction}
\label{sec:1}

Generalized Plasticity Theory introduced by Mroz and Zienkiewicz (1984) provides a general framework to develop hierarchical models to describe the material behavior under monotonic and cyclic loading. The first generalized plasticity model was proposed by Pastor, Zienkiewicz and Chan in 1990 ~\cite{PastorZC:90} without requiring an explicit definition of yield and plastic potential surfaces, nor consistency conditions in order to determine plastic modulus. Complex monotonic and cyclic loading paths for granular materials can be simulated within the Generalized Plasticity Framework as: static and cyclic liquefaction, cyclic mobity and densification. Several contributions were made in order to improve the original model in different ways. It is worth mentioning works on anisotropic soils (Pastor 1992), degradation phenomena (Fernandez Merodo et al 2004), unsaturated soils (Bolson et al 1999, Tamagnini & Pastor 2000) and more recently the implicit integration of the plastic state~\cite{Mira2009}, the unified approach based on state parameter for saturated~\cite{Manzanal2011} and unsaturated~\cite{Manzanal2011a} soils and crushable granular materials (Javanmardi et al 2018, Manzanal et al 2019).

The model has been implemented within  full coupled  $u-p_w$ formulation in the Finite Element Code GeHoMadrid (Fernandez Merodo et al. 2004 ) to study several boundary value problems in small strain as marine foundation (Mira et al. 2018), slope stability (Pastor et al. 2009, 2011) and dynamic problems  (Querol et al. 2005, Manzanal et al. 2019). 

Catastrophic failure of geostructures involve large masses of soils which fluidize and develop large deformations (Seed et al 1975, Olson & Stark 2002, Pastor et al. 2009). Most of them involve saturated sands or silty sands subjected to a static loading or cyclic loading such as earthquake-induced loading. It is well known that the stress-strain behavior of granular soils is different depending on initial conditions: relative density and confinement pressure; velocity and type of load: static, cyclic or dynamic; and conditions of drainage: drained, partially drained or undrained. Drainage conditions are conditioned by the relative permeability of soils and their variation during post failure. When permeability tends to be high, the relative movement of the water and solid phase would take relevance such as dynamic problem with a high frequency loading (Querol et al 2005) or diffuse failures of loose granular materials with high mobility (Pastor et al. 2010). 

Thus, the employment of the traditional $u-p_w$ formulation of the governing equations, even in the dynamic form, is not sufficient  the hydro-mechanical response in saturated soils requiring the complete formulation $u-w$ ~\cite{zienkiewicz1984}. Zienkiewicz ~\textit{et al.} ~\cite{zienkiewicz1980} made an assessment of the suitability of the usage of the complete formulation depending on the frequency of the loading and the permeability. The dynamic consolidation problems studied in that research were analyzed by Navas ~\textit{et al.} ~\cite{Navas2016b} in the elastic range and also by L\'opez-Querol~\textit{et al.} ~\cite{LopezQuerol2006} within the Generalized Plasticity model for small strains. When a soil element is deform up to $3\%$ or more, the small strain approach lacks of non linear behaviour related with finite strains.Taking in to account that such range of deformations is not unusual in practical geotechnical engineering, the extension of the $u-w$ formulation to a large deformation framework seems to be required.
Although this $u-w$ finite strain approach has been considered in previous researches ~\cite{Navas2016}, to the authors' knowledge, no attempt has been devoted to include an elastoplastic behaviour from the Generalized Plasticity theory, suitable for modeling sands under both monotonic and dynamic loads. This is the main contribution of the present work. The new model is numerically solved using an optimal transportation meshfree approach that is known to provide excellent results when there are large deformations.


This paper is organized as follows:  In section \ref{sec:2} the methodology is presented, being divided in three subsections where the $u-w$ formulation, the time integration scheme and the spatial discretization. In section \ref{sec:3} the constitutive model are described; the validation of the numerical approach is presented in section \ref{sec:4}, being analyzed the monotonic compressive triaxial sand behavior under drained and undrained conditions test. The performance of the implementation on cyclic behaviour is analyzed in section \ref{sec:5} for both conditions also. Finally, conclusions are presented in section \ref{sec:6}.

\section{Governing equations, weak form and discretization procedures}\label{sec:2}
\subsection{The $u-w$ formulation}
\label{subsec:21}
The main idea of this formulation is the employment of the displacement of the solid and the relative displacement of the fluid as nodal variables. In the literature~\cite{LewisSchrefler98} $\boldsymbol{u}^{ws}$, the relative motion of the fluid with respect to the solid, is defined as $\boldsymbol{  \left(U-u\right) }$, where $\boldsymbol{u}$ and  $\boldsymbol{U}$ respectively stand for displacement vectors of the solid skeleton and the absolute displacement of the fluid phase. The rearrangement of these two gives us the relative displacement of the fluid phase, $\boldsymbol{w}$, with respect to the solid skeleton through the porosity as follows \cite{LopezQuerol2008},
\begin{equation}\label{eq_uw1}
\boldsymbol{ w }=n \boldsymbol{  \left(U-u\right) }.
\end{equation}
being the porosity, $n$ calculated as
\begin{equation}\label{eq_uw3}
n= \frac{V_h}{V_h+V_s},
\end{equation}
where $V_h$ and $V_s$ are the volumes of the voids and solid grains respectively. 
Note that in the current work,   totally saturated porous medium is assumed, i.e., $V_h$ coincides with the water volume, which results in  $S_w$ equal to 1~\cite{LewisSchrefler98}. Thus, similarly, the mixture density, $\rho$, is derived from the ones of the fluid and solid particles, $\rho_w$ and $\rho_s$, as follows:
\begin{equation}\label{eq_uw2}
\rho=(1-n) \rho_s + n \rho_{w}.
\end{equation}

The mass balance equation of the liquid water phase in a isothermal totally saturated media, being compressible water and soil grains and constant the water density, yields ~\cite{LewisSchrefler98}
\begin{equation}
\frac{\dot{ p}_w}{Q} +  \mbox{div }  \boldsymbol{\dot{u}} + \mbox{div } \boldsymbol{\dot{w}} = 0 \label{eq_uw10}.
\end{equation}

  $Q$ represents the volumetric compressibility of the mixture, taking into account that the solid grains are much less compressible than the porous skeleton, is expressed in terms of the bulk modulus of the solid grains, $K_s$, and the compressive modulus of the fluid phase (water), $K_w$, \cite{Zienkiewicz99} i.e.,
 \begin{equation}\label{eq_uw4}
Q = \left[ \frac{1-n}{K_s} + \frac{n}{K_w} \right]^{-1}.
\end{equation}

%%%%%
In the whole research, the employment of $K_w=1e4\,$MPa, $K_s=1e36\,$MPa, $\rho_s=2600 \, kg/m^3$ and $\rho_s=1000 \, kg/m^3$ has been considered. Equation \eqref{eq_uw10} can be integrated over time to obtain the pore pressure as
\begin{equation}\label{eq_uw15}
p_w=-Q \left[ \mbox{div} (\boldsymbol{u}) + \mbox{div} (\boldsymbol{w}) \right] +p_{w_0},
\end{equation}
where $p_{w_0}$ is the initial pore pressure.
%%%%%

On the other hand, Lewis and Schrefler~\cite{LewisSchrefler98} also give the linear momentum balance equation for the multiphase system under saturated conditions as the summation of the dynamic equations for the individual constituents relative to the solid.
\begin{equation}\label{eq_uw14}
\mbox{div}\boldsymbol{ \sigma} -\rho\boldsymbol{\ddot{u}} -\rho_w\boldsymbol{\ddot{w}}+\rho\boldsymbol{g}=\boldsymbol{0}.
\end{equation}
%%%%

%With respect to the sign criterion for stresses and strains, tensile ones are assumed positive,  except for the pore pressure, $p_w$, which is negative for tension.

 where, taking into account Terzaghi's effective stress theory ~\cite{Terzaghi1925}, the total Cauchy stress tensor, $\boldsymbol{ \sigma}$ can be written in terms of the effective stress, $ \boldsymbol{ \sigma'}$, and the pore pressure, $p_w$, as follows:
\begin{equation}\label{eq_uw5}
 \boldsymbol{ \sigma'} =\boldsymbol{ \sigma} + \alpha p_{w}\textbf{I},
\end{equation}
where  $\textbf{I}$ is  the second order unit tensor.  

Finally, the third Biot's equation is derived from the general form of Darcy's law for any fluid phase:
\begin{equation}\label{eq_uw12}
-\mbox{grad }p_w -\frac{\mu_w}{k}\boldsymbol{\dot{w}}+ \rho_w \left (\boldsymbol{g}-\boldsymbol{\ddot{u}}-\frac{\boldsymbol{\ddot{w}}}{n} \right)=\boldsymbol{0}.
\end{equation}
where $\dot{\boldsymbol{w}}/n$ represents the relative velocity of the fluid, taking into account that $\dot\Box$ is the material time derivative of $\qed$ with respect to the solid; $\boldsymbol{\ddot{u}}$ denotes the solid phase acceleration, $\ddot{\boldsymbol{w}}/n$ is the relative acceleration of the fluid respect to the solid phase, $\boldsymbol{g}$ represents the external acceleration vector, $\mu_w$ denotes the dynamic viscosity of the water and $\boldsymbol{k}$ is the intrinsic permeability tensor, which becomes a unit tensor multiplied by the scalar $k$, intrinsic permeability, when isotropic permeability is assumed.

Both linear momentum balance equations of the mixture and the fluid were presented by Zienkiewicz \textit{et al.} \cite{Zienkiewicz99} with the convective terms, which can be neglected in the present research as the vorticity is relatively small compared to the rest of the terms.

\subsection{Weak form for the $u-w$ formulation}
\label{subsec:21_a}
The weak form of the system equations for the $u-w$ formulation is obtained applying the principle of virtual displacements to the   linear momentum   equation of both the solid and fluid phases, Eqs.~\eqref{eq_uw12} and~\eqref{eq_uw14}.

Taking $\delta\boldsymbol{u}$ and $\delta \boldsymbol{w}$ as the virtual displacement vector for the solid and fluid phase respectively, the weak form of the linear momentum balance equations, once the definition of the pore pressure, $p_w$, of the equation ~\eqref{eq_uw15} is introduced in both Eqs. ~\eqref{eq_uw14} and ~\eqref{eq_uw12} and Green's Theorem is applied, yields:

\begin{eqnarray} \label{eq_uw19_2}
&&-\int_B \boldsymbol{ \sigma'}:\mbox{grad}(\delta\boldsymbol{u}) \, dv \; -\int_B Q \, \mbox{div}(\boldsymbol{u}) \boldsymbol{I}:\mbox{grad}(\delta\boldsymbol{u}) \, dv  - \int_B Q \, \mbox{div}(\boldsymbol{w}) \boldsymbol{I} : \mbox{grad}(\delta\boldsymbol{u}) \, dv
\nonumber \\
&&+ \int_B \left[-\rho\boldsymbol{\ddot{u}}-\rho_w\boldsymbol{\ddot{w}}+\rho\boldsymbol{g}\right]\cdot\delta\boldsymbol{u} \, dv + \int_{\delta B}\boldsymbol{\overline{t}}\cdot\delta\boldsymbol{u} \, ds=0.
\end{eqnarray}

\begin{eqnarray} \label{eq_uw20_2}
&&-\int_B Q \, \mbox{div} (\boldsymbol{u}) \mbox{div}(\delta \boldsymbol{w}) \, dv  -\int_B Q \, \mbox{div} (\boldsymbol{w}) \mbox{div}(\delta \boldsymbol{w}) \, dv \, -\int_B\frac{\mu_w}{k}\boldsymbol{\dot{w}}\cdot\delta \boldsymbol{w} \, dv
\nonumber\\
&&- \int_B \boldsymbol{\ddot{w}}\frac{\rho_w}{n} \cdot\delta \boldsymbol{w} \, dv \, +\int_B \rho_w(\boldsymbol{g}-\boldsymbol{\ddot{u}}) \cdot\delta \boldsymbol{w} \, dv -\int_{\delta B}\boldsymbol{\overline{t}}_w\cdot\delta\boldsymbol{w} \, ds =0.
\end{eqnarray}\\

where $B$ is the volume of the spatial domain and $\delta B$ the boundary where the traction $\boldsymbol{\overline{t}}$ and $\boldsymbol{\overline{t}}_w$, both traction of the solid and fluid phase, are applied.

\subsection{Implicit time integration scheme: Newton-Raphson algorithm}
\label{subsec:22}
In the $u-w$ formulation each node contains both solid and fluid degrees of freedom, $\boldsymbol{u}$ and $\boldsymbol{w}$, whereas the pore pressure, $p_w$ is not considered as a degree of freedom, being calculated at the material point employing Eq.~\eqref{eq_uw15}, in contrast with the more traditional  $u-p_w$ formulation, where is considered directly as an additional nodal unknown. On the one hand, the imposition of impervious boundary conditions is a bit easier in the $u-w$ meanwhile the initial conditions require an initial calculation of the relative displacement of the water, $w$, when an initial pore pressure is assumed. This calculation is further explained in~\ref{ap:1}.

In the proposed study, an axisymmetric 2D configuration is employed in order to represent the triaxial tests. As a two-dimensional problem, the nodal unknowns can be written as:
 $$
 \boldsymbol{u}^*=
 \left[ u_x \quad  u_y \quad   w_x \quad  w_y \right]^T.
$$
After assembling the elementary matrices, the final system of equations can be simplified as
\begin{equation}\label{eq_uw26}
 \boldsymbol{ R}_{k+1}  +  \boldsymbol{C}  \,   \boldsymbol{\dot{u}}_{k+1} +   \boldsymbol{M}   \, \boldsymbol {\ddot{u}}_{k+1}= \boldsymbol{P }_{k+1},
\end{equation}
where   $\boldsymbol{R}$, $ \boldsymbol{C}$ and $  \boldsymbol{ M}$ respectively denote the internal forces vector and damping and mass matrices, whereas $ \boldsymbol{P}$ is the external forces vector, which contains both gravity acceleration and external nodal forces. ${k+1}$ represents the current step.

In order to solve Eq.~(\ref{eq_uw26}) in an implicit way, a traditional Newmark time integration scheme with $\gamma=$0.6 and $\beta=$0.325. (suitable for dynamic problems~\cite{Kontoe2006})is employed. Inserting this scheme into Eq.~(\ref{eq_uw26}),  the equations for the unknowns can be re-written as:
\begin{eqnarray}\label{eq_uw30}
\boldsymbol {G}_{k+1} &=& \boldsymbol {M}\left[\alpha_1\Delta\boldsymbol {u}_{k+1}-\alpha_2\boldsymbol {\dot{u}}_{k}-\alpha_3\boldsymbol {\ddot{u}}_{k}\right] \nonumber\\
&+& 
\boldsymbol {C}\left[\alpha_4\Delta\boldsymbol {u}_{k+1} + \alpha_5\boldsymbol {\dot{u}}_{k} + \alpha_6\boldsymbol {\ddot{u}}_{k}\right] 
\nonumber\\
&+& \boldsymbol {R}_{k+1}-\boldsymbol {P}_{k}-\Delta\boldsymbol {P}_{k+1}=\boldsymbol {0},
\end{eqnarray}

or  in the compact form:
\begin{eqnarray} \label{eq_uw23}
\boldsymbol{G}(\boldsymbol{\chi},\boldsymbol{\eta})&=&\boldsymbol{0},\\
\mbox{where} \quad \boldsymbol{\chi}&=&\left[ \boldsymbol{\chi^u} ,\boldsymbol{\chi^w}\right]^{T} \quad  \mbox{is the deformation mapping}
\nonumber \\
\mbox{and} \quad 
\boldsymbol{\eta}&=&\left[\delta\boldsymbol{u},\delta\boldsymbol{w}\right]^T \, , \; \Delta\boldsymbol{u^*}=\left[\Delta\boldsymbol{u},\Delta\boldsymbol{w}\right]^T.
\nonumber
\end{eqnarray}
where the $\alpha$-parameters are listed in Table~\ref{tab1} according to Wriggers~\cite{wriggers:08}. These coefficients can be easily extended to any other time integration schemes. 

%%%
\begin{table}
\caption{\label{tab1} The $\alpha$-parameters of the Newmark scheme.} 
\centering
	%\vspace*{0.6cm}
	\begin{tabular}{lll}
	 $\alpha_1=\frac{1}{\beta\Delta t^2}$ & 	 $\alpha_2=\frac{1}{\beta\Delta t}$ & 
	 $\alpha_3=\frac{1}{2\beta}-1$ \\
	 $\alpha_4=\frac{\gamma}{\beta\Delta t}$ &  
	 	 $\alpha_5=1-\frac{\gamma}{\beta}$&
	 $\alpha_6=\left(1-\frac{\gamma}{2\beta}\right)\Delta t$
	\end{tabular}
\end{table}

According to Wriggers~\cite{wriggers:08}, to solve the above non-linear equations, any Newton method  can be applied by using the following statement, after the linearization of $ \boldsymbol{\chi}$: 
\begin{eqnarray} \label{eq_uw24}
\boldsymbol{G}(\boldsymbol{\overline{\chi}},\boldsymbol{\eta})_{k+1}^{i}+D\boldsymbol{G}(\boldsymbol{\overline{\chi}},\boldsymbol{\eta})_{k+1}^{i}\cdot \Delta\boldsymbol{u}^{*i+1}_{k+1} &\cong & \boldsymbol{0},
\end{eqnarray}
where $\boldsymbol{\overline{\chi}}$ is the already linearized deformation mapping. Thus, the iterative procedure, taking into account the matrices that are involved in our problem, yields:
\begin{eqnarray}\label{eq_uw32}
\left[\alpha_1\boldsymbol {M}+\alpha_4\boldsymbol {C}+\boldsymbol {K}^{i}_{k+1}\right]\Delta\boldsymbol{u}^{i+1}_{k+1} &=& -\boldsymbol {G}(\boldsymbol {u}^{i}_{k+1}), \\
\mbox{where}\;\; \boldsymbol {u}^{i+1}_{k+1} &=& \boldsymbol {u}^{i}_{k+1} + \Delta \boldsymbol {u}^{i+1}_{k+1}.  \nonumber 
\end{eqnarray}
where $\boldsymbol {K}$ is the tangential stiffness matrix:
\begin{equation}\label{eq_uw31}
\boldsymbol {K}(\boldsymbol {u}^{i}_{k+1})=\boldsymbol {K}^{i}_{k+1}=\left.\frac{\partial\boldsymbol {R}}{\partial \boldsymbol {u}}\right|_{\boldsymbol{u}^{i}_{k+1}}.
\end{equation}
and $i$ depicts the iteration index. The iteration finishes when  $\boldsymbol {G}^{i}_{k+1}$ is lower than a given tolerance.

After applying the integration in time,  Eq.~(\ref{eq_uw19_2}) and Eq.~(\ref{eq_uw20_2}) are written at time $_{k+1}$ and transformed as follows:
\begin{eqnarray} \label{eq_uw34}
&&-\int_B \boldsymbol{ \sigma'}:\mbox{grad}(\delta\boldsymbol{u}) \, dv \; -\int_B  Q \, \mbox{div}(\boldsymbol{u}) \mbox{div}(\delta\boldsymbol{u}) \, dv  \nonumber \\ 
&& -\int_B  Q \, \mbox{div}(\boldsymbol{w}) \mbox{div}(\delta\boldsymbol{u}) \, dv \;  - \alpha_1 \int_B \left[\rho\boldsymbol{u}+\rho_w \boldsymbol{w}\right]\cdot\delta\boldsymbol{u} \, dv 
\nonumber \\
&&+ \int_B \rho\boldsymbol{g}\cdot\delta\boldsymbol{u} \, dv+ \alpha_8 \int_{\delta B} \boldsymbol{\overline{t}}\cdot\delta\boldsymbol{u} \, ds=\boldsymbol{0}
\end{eqnarray}
\begin{eqnarray} \label{eq_uw35}
&&-\int_B Q \, \mbox{div}(\boldsymbol{u}) \mbox{div}(\delta \boldsymbol{w}) \, dv  -\int_B Q \, \mbox{div}(\boldsymbol{w}) \mbox{div}(\delta \boldsymbol{w}) \, dv 
\nonumber\\
&&- \alpha_4\int_B\frac{\mu_w}{k}\boldsymbol{w} \cdot \delta \boldsymbol{w} \, dv 
-\alpha_1 \int_B \frac{\rho_w}{n}\boldsymbol{w}\cdot \delta \boldsymbol{w} \, dv
\nonumber\\
&&-\alpha_1\int_B \rho_w\boldsymbol{u} \cdot \delta \boldsymbol{w} \, dv+\int_B \rho_w\boldsymbol{g} \cdot \delta \boldsymbol{w} \, dv 
\nonumber\\
&&-\int_{\delta B}\boldsymbol{\overline{t}}_w\cdot\delta\boldsymbol{w} \, ds =\boldsymbol{0}.
\end{eqnarray}
The results of the linearization process for  Eq.~(\ref{eq_uw34}) and Eq.(\ref{eq_uw35}) are given in Eq.~(\ref{eq_r1}) and Eq.~(\ref{eq_r2}) respectively in \ref{ap:2}. More details of the linearization process are given in~\cite{Navas:17c}.

%%%%%%%%%%%%%%%%
\subsection{A note on spatial discretization}
\label{subsec:23}
The shape function employed is based that of Arroyo and Ortiz ~\cite{arroyo2006}, who defined exponential  functions based on the principle of  the local maximum entropy (LME).  For a node $a$, it reads,
\begin{equation} \label{eq_N1}
N_a(\textbf{x})=\frac{\exp\left[ -\beta \; |\bf x-x_a|^2 +  \boldsymbol{\lambda}  \cdot  (x-x_a)         \right] } {Z(\textbf{x},\boldsymbol{\lambda}^*(\textbf{x}))},
\end{equation}
where
\begin{equation}\label{eq_N2}
Z({\bf x}, {\boldsymbol{\lambda}}) = \sum_{a=1}^{N_b}{ \exp \left[ -\beta \, |{\bf x-x_a}|^2 + \boldsymbol{\lambda}  \cdot  \bf {(x-x_a)}         \right]}.
\end{equation}
$N_b$ represents the neighborhood size. The parameter $\beta$ defines the shape of the neighborhood and $\boldsymbol{\lambda}(\bf x)$ comes from the minimization of the function $g(\boldsymbol{\lambda})=\log Z(\bf x, \boldsymbol{\lambda})$ to guarantee the maximum entropy. The first derivatives of the shape function are then obtained from differentiating the shape function itself to get the Hessian matrix \textbf{J}  in the following expression:
\begin{eqnarray}
\nabla N_a &=& -N_a \,  \textbf{J}^{-1} \,  (\bf x-x_a) \label{eq_N3}.
\end{eqnarray}

A modified Nelder-Mead algorithm developed by Navas {\it et al.}~\cite{Navas2018} is used for the minimization process in the current work.
 
\section{A Generalized Plasticity model for sands in a finite strain setting  
}
\label{subsec:24}
As it was mentioned above, the main contribution of the present work is to adjust for the first time a Generalized Plasticity constitutive model within a large deformation framework. The main strain measurements are the deformation gradient tensor $\mathbf{F}$ and $\mathbf{F}^w$ of the solid skeleton and pore fluid, respectively, calculated in an incremental way thanks to the updated lagrangian approach~\cite{Bonet2008}. For both phases, the increments of the deformation gradient tensor are calculated by means of the gradient of the Local Max-Ent shape functions, Eq.~\eqref{eq_N3}, as follows:

\begin{eqnarray}
\Delta \mathbf{F}_{k+1} &=& I+\sum_{a=1}^{Nb}\Delta u_{k+1}^a \otimes \nabla N^a(x_{k}^p), \\
\Delta \mathbf{F}^w_{k+1} &=&I+\sum_{a=1}^{Nb}\Delta w_{k+1}^a \otimes \nabla N^a(x_{k}^p)
\end{eqnarray}

where the superscript $p$ represents the material point where is calculated and $Nb$ the neighbor nodes of this material point. The deformation gradient can be calculated as:

\begin{equation}
\mathbf{F}_{k+1} = \Delta \mathbf{F}_{k+1} \mathbf{F}_{k} 
\end{equation}
where $k$ and $k+1$ depict the previous and the current step, respectively.

The methodology that is employed in this research reproduces the proposed by Navas~\textit{et al.}~\cite{Navas:17c} for the pore pressure and stress update. Therefore, following the work of Cuiti\~no and Ortiz \cite{cuitino:92}, the small strain measures $\boldsymbol{\varepsilon} = \frac{1}{2}\,\log\mathbf{b}$ and $\boldsymbol{\varepsilon}^w = \frac{1}{2}\,\log\mathbf{b}^w$ are considered for each phase, where $\mathbf{b}=\mathbf{F}\mathbf{F}^T$ and $\mathbf{b}^w=\mathbf{F}^w\mathbf{F}^w^T$ are the left Cauchy-Green strain tensors for the solid skeleton and pore fluid, respectively.

Regarding the pore pressure, which comes from the mass conservation equation, Eq.~\eqref{eq_uw15}, it is calculated as:
\begin{equation}
p_w&=&-Q \left( \mbox{div } \boldsymbol{u} + \mbox{div } \boldsymbol{w} \right) 
\end{equation}

where the divergences of the displacements of both phases can be expressed as:

\begin{eqnarray}
\mbox{div }(\boldsymbol{u}) &=& \mbox{tr}(\boldsymbol{\varepsilon})=\mbox{tr} \left (\frac{1}{2}\,\log\mathbf{b} \right), \\
\mbox{div }(\boldsymbol{w}) &=& \mbox{tr} (\boldsymbol{\varepsilon}^w)=\mbox{tr} \left(\frac{1}{2}\,\log\mathbf{b}^w \right).
\end{eqnarray}

The stress state update of the solid skeleton through a generalized plasticity model within a finite strain setting is clarify hereafter. 

In order to develop a thermodynamically consistent finite deformation constitutive relation in the current configuration \cite{Borja1998}, the effective Kirchhoff stress tensor $\boldsymbol{\tau}'$ is considered as stress measure, which is defined as $\boldsymbol{\tau}'=J \boldsymbol{\sigma}'$ where $J=det(\mathbf{F})$ and $\boldsymbol{\sigma}'$ is the effective Cauchy stress tensor. Moreover, the small strain increment that induces the stress state update is defined by 

\begin{equation}
\Delta \boldsymbol{\varepsilon}= \frac{1}{2} (\log\mathbf{b}_{k+1}-\log\mathbf{b}_{k})  
\end{equation}\label{Eq_B_tr}

The update driven by $\Delta \boldsymbol{\varepsilon}$  from $( \boldsymbol{\tau}'_k, \boldsymbol{\varepsilon}^p_k)$ to $( \boldsymbol{\tau}'_{k+1}, \boldsymbol{\varepsilon}^p_{k+1})$ can be performed within the standard generalized plasticity framework ~\cite{Mira2009} by the following incremental constitutive equations:

\begin{eqnarray}
\Delta\boldsymbol{\varepsilon} &=& \Delta\boldsymbol{\varepsilon}^e+\Delta\boldsymbol{\varepsilon}^p\label{Eq4}\\ 
\Delta\boldsymbol{\varepsilon}^p &=& \Delta \lambda \boldsymbol{n}_g\label{Eq5}\\ 
\Delta \lambda &=& \frac{\boldsymbol{n}:\boldsymbol{D}^e: \Delta \boldsymbol{\varepsilon}}{H_{L/U}+\boldsymbol{n}:\boldsymbol{D}^e:\boldsymbol{n}_g}\label{Eq6}\\
\boldsymbol\tau' &=& \frac{\partial \psi}{\partial \boldsymbol{\varepsilon}^e}, \quad \boldsymbol{D}^e = \frac{\partial^2 \psi}{\partial \boldsymbol{\varepsilon}^{e \, 2}} \label{Eq7}
\end{eqnarray}

where $ \boldsymbol{n}$ and $ \boldsymbol{n}_g$ are the loading and plastic flow tensor directions, respectively, $H_{L/U}$ are the scalar functions defined as the plastic moduli for loading and unloading, $\psi$ is a free energy function while $\boldsymbol{\tau}'$ is the effective Kirchhoff stress tensor and $\boldsymbol{D}^e$ is the elastic tangent tensor. An appropriate selection of $ \boldsymbol{n}$, $ \boldsymbol{n}_g$, $H_{L/U}$ and $\psi$ will lead to different models within the generalized plasticity framework.

Once the plastic strains increment   $\Delta\boldsymbol{\varepsilon}^p$ are computed by (\ref{Eq5}), then the free energy function $\psi$ is updated with the new elastic small strain $\boldsymbol{\varepsilon}^e_{k+1}$, which is computed by (\ref{Eq4}). Then, by differentiation of the free energy function, the current effective stress $\boldsymbol{\tau}'_{k+1}$ is obtained. Finally, as the internal forces in (\ref{eq_uw34}) are computed through the effective Cauchy stress tensor, this one is computed by $\boldsymbol{\sigma}'_{k+1}= \frac{1}{J}\boldsymbol{\tau}'_{k+1}$.

Following the standard generalized plasticity framework, an isotropic material response is assumed. Therefore, the constitutive equation will be written in terms of the effective Kirchhoff stress tensor invariants  $p', q, \theta $ and the work-conjugate strain invariants $\varepsilon_v, \varepsilon_s, \theta^{\varepsilon}$ . These invariants are defined in the usual way as

\begin{eqnarray}
p' &=&-\frac{1}{3}I_1 \label{Eq8}\\ 
q &=&(3J_2)^{1/2}\label{Eq9} \\
\theta &=& \frac{1}{3} \sin^{-1}\left(\frac{-3\sqrt{3}}{2}\frac{J_3}{J_2^{3/2}}\right)\label{Eq10} 
\end{eqnarray}

where $I_1$ is the first invariant of the effective Kirchhoff stress tensor $\boldsymbol{\tau}'$,  while $J_2$ and $J_3$ are the second and third invariant of the deviatoric Kirchhoff stress tensor $\boldsymbol{s}=\boldsymbol{\tau}'-p\boldsymbol{I}$ . Negative sign in Equation \eqref{Eq8} stands for positive values of $p'$ in compression. The strain invariants $\varepsilon_v, \varepsilon_s, \theta^{\varepsilon}$ are defined by


\begin{eqnarray}
\varepsilon_v &=&- tr(\boldsymbol{\varepsilon})\label{Eq11}\\ 
\varepsilon_s &=&\sqrt{\frac{2}{3}}\Vert \boldsymbol{\varepsilon}_{dev} \Vert \label{Eq12}\\ 
\theta^{\varepsilon} &=& \sin^{-1}\left(\frac{-3\sqrt{3}}{2}\frac{J^{\varepsilon}_3}{J_2^{\varepsilon \, 3/2}}\right)\label{Eq13} 
\end{eqnarray}



where $J^{\varepsilon}_2$ and $J^{\varepsilon}_3$ denote the second
and third invariants of deviatoric strain tensor $\boldsymbol{\varepsilon}_{dev}$, respectively. Negative sign in Equation \eqref{Eq11} stands for positive values of $\varepsilon^_v$ in compression. However, the sign of $\varepsilon_s$ is closely related to the orientation in the triaxial space, \textit{i.e.}, the Lode's angle $\theta^{\varepsilon}$ of the strain path: if $\sin \theta^{\varepsilon}$ is lower than 0, we consider the load in tension and the sign of $\varepsilon_s$ negative, meanwhile $\varepsilon_s$ is positive on any other situation. Working in the triaxial space is an aspect that allows as to reduce the computational effort since only three variables define the state of the material point.

The isotropic assumption also allows to define a two invariant stored energy function $\psi\left(\varepsilon_{v}^{\mathrm{e}}, \varepsilon_{s}^{\mathrm{e}}\right)$. In this work, the hyperelastic HAR model~\cite{Houlsby2005} has been employed, with the reduced version ($n=1$). This free Energy function is represented by the following equation:

\begin{equation}
\psi\left(\varepsilon_{v}^{\mathrm{e}}, \varepsilon_{s}^{\mathrm{e}}\right)=\frac{p_{a}}{K_0} \cdot \exp \left(K_0 \cdot \varepsilon_{v}^{\mathrm{e}}+\frac{3 G_0 K_0\left(\varepsilon_{s}^{\mathrm{e}}\right)^{2}}{2}\right)\label{Eq14} 
\end{equation}

Invariants $p'$ and $q$ can be calculated from this function by differentiation with respect to the strain invariants $\varepsilon_{v}^{\mathrm{e}}$ and $\varepsilon_{s}^{\mathrm{e}}$, \textit{i.e.}, $p'=\frac{\partial \psi}{\partial \varepsilon_v^e}$ and $q=\frac{\partial \psi}{\partial \varepsilon_s^e}$. Moreover, the effective Kirchhoff stress tensor $\boldsymbol{\tau}'$ and the elastic tangent tensor $\boldsymbol{D}^e$ can be written as

\begin{equation}
\boldsymbol{\tau}'= p' \boldsymbol{I}+ \sqrt{\frac{2}{3}}q\hat{\boldsymbol{n}}
\label{Eq15} 
\end{equation}

\begin{eqnarray}
     \boldsymbol{D}^{\mathrm{e}} = D_{11}^{\mathrm{e}} \boldsymbol{I}\otimes \boldsymbol{I}+\sqrt{\frac{2}{3}} D_{12}^{\mathrm{e}} \boldsymbol{I} \otimes \hat{\boldsymbol{n}}+\sqrt{\frac{2}{3}} D_{21}^{\mathrm{e}} \hat{\boldsymbol{n}} \otimes \boldsymbol{I} &\nonumber\\ 
    +\sqrt{\frac{2}{3}}\frac{q}{\Vert\boldsymbol{\varepsilon}_{dev}^e\Vert} \mathbf{M}_1 +\sqrt{\frac{2}{3}}\left(\sqrt{\frac{2}{3}}  D_{22}^{\mathrm{e}} - \frac{q}{\Vert\boldsymbol{\varepsilon}_{dev}^e\Vert}\right)\hat{\boldsymbol{n}} \otimes \hat{\boldsymbol{n}}&
    \label{Eq16} 
\end{eqnarray}


where $\boldsymbol{I}$ is the second order identity tensor and $\hat{\boldsymbol{n}}$ is the normalized deviatoric elastic strain tensor, i.e., $\hat{\boldsymbol{n}}=\frac{\boldsymbol{\varepsilon}_{dev}^e}{\Vert\boldsymbol{\varepsilon}_{dev}^e\Vert}$. Moreover, the components $D^e_{ij}$ appearing in (\ref{Eq16}) are defined as $D^e_{ij}=\frac{\partial^2 \psi}{\partial \varepsilon_i^e \partial \varepsilon_j^e}$ with $\left \{i,j\right \}=\left \{1,2\right \}=\left \{v,s\right \}$, while $\mathbf{M}_1 $ is defined by:
\begin{equation}
\mathbf{M}_1 = \boldsymbol{1} - \frac{1}{3	}\left( \boldsymbol{I} \otimes \boldsymbol{I} \right)
\end{equation}
where $\boldsymbol{1}$ is the fourth order identity tensor. 

Once more by the isotropic assumption, the loading direction $ \boldsymbol{n}$ and the plastic flow tensor direction $ \boldsymbol{n_g}$ are defined in the Kirchhoff stress invariant space $p', q, \theta $ by the expressions:

\begin{eqnarray}
n &=\left(n^{p}, n^{q}, n^{\theta}\right)^{\mathrm{T}} \\ n_{g,L} &=\left(n_{g,L}^{p}, n_{g}^{q}, n_{g}^{\theta}\right)^{\mathrm{T}}
\\ n_{g,U} &=\left(n_{g,U}^{p}, n_{g}^{q}, n_{g}^{\theta}\right)^{\mathrm{T}}
\end{eqnarray}
where the components are described in Table \ref{tab1}.

\begin{table}[H]
\caption{\label{tab1} $n_{g}$ and $n$ components.} 
\centering
	\begin{tabular}{l|l}
        $n^{p} =\frac{d_{f}}{\sqrt{1+d_{f}^{2}}}$ &
        $n_{g,L}^{p} =\frac{d_{g}}{\sqrt{1+d_{g}^{2}}}$
        \\ 
         &
        $n_{g,U}^{p} = -\Vert n_{g,L}^{p} \Vert$ \\
        $n^{q} =\frac{\pm 1}{\sqrt{1+d_{f}^{2}}}$ &
        $n_{g}^{q} = \frac{\pm 1}{\sqrt{1+d_{g}^{2}}}$ \\  
        $n^{\theta} =-\frac{q M_{f} \cos 3 \theta}{2 \sqrt{1+d_{f}^{2}}}$ &
         $n_{g}^{\theta} =-\frac{q M_{g} \cos 3 \theta}{2 \sqrt{1+d_{g}^{2}}}$
	\end{tabular}
\end{table}

Similar expression are derived for $d_{g}$ and $d_{f}$. $d_{g}$ is obtained from laboratory tests as a function of dilatancy, represented by  $d_{g}=\left(1+\alpha_{g}\right)\left(M_{g}-\eta\right)$ and, $d_{f}$ has a similar expression, represented by   $d_{f}=\left(1+\alpha_{f}\right)\left(M_{f}-\eta\right)$. The parameter $M_{g}$ is slopes of the critical state lines in the q-p plane. $M_{f}$ is parameter related with $M_{g}$ througth the relative density $D_r = M_{f} / M_{g}$  .$\alpha_{g}$ and $\alpha_{f}$ are model parameters. $\eta$ depicts the current relation between $q/p$. As we see in Table~\ref{tab1}, the deviatoric component can take positive or negative sign, which depends on the sign of the invariant $q$, if it is in extension (negative) or compression (positive).

 On the other hand, the plastic moduli $H_{L / U}$ for loading and unloading are defined in a different way depending on the loading or unloading conditions. For loading $H_L$ the following applies :
\begin{equation}
H=p\,H_{0}  H_{f}\left(H_{v}+H_{s}\right) H_{\mathrm{DM}}
\end{equation}\label{Eq_H}
where $H_0$ is a material parameter that Schrefler and coworkers~\cite{Santagiuliana2006} related to the traditional slopes of the plastic and elastic curves in the $p-e$ curve:
\begin{equation}
H_{0}=\frac{1+e_{0}}{\lambda-k}=\frac{1}{\lambda^*-k^*}
\end{equation}

The rest of the parameters are defined following:
\begin{equation}
\begin{aligned} H_{\mathrm{f}} &=\left(1-\frac{\eta}{\eta_{\mathrm{f}}}\right)^{4} \\ 
H_{v} &=\left(1-\eta / M_{g}\right) \\ 
H_{s} &=\beta_{0} \beta_{1} \exp \left(-\beta_{0} \xi\right) \\ 
H_{\mathrm{DM}} &=\left(\frac{\zeta_{\mathrm{max}}}{\zeta}\right)^{\gamma_{\mathrm{DM}}} \end{aligned}
\end{equation}
where:
\begin{equation}
\begin{aligned} 
\eta_{\mathrm{f}} &=\left(1+\frac{1}{\alpha_{\mathrm{f}}}\right) M_{\mathrm{f}} \\ 
\zeta &=p^{\prime}\left\{1-\left(\frac{\alpha_{g}}{1+\alpha_{g}}\right) \frac{\eta}{M_{g}}\right\}^{-1 / \alpha_{g}} \end{aligned}
\end{equation}
$\zeta_{\mathrm{max}}$ is the maximum value of $\zeta$ along the computation and $\xi$ is the cumulative deviatoric plastic strain, $\int\left|\mathrm{d} \varepsilon_{s}^{p}\right| $. On the other hand, if the process lies on the unloading, $H_U$ depends on the relation $\left|\frac{M_{g}}{\eta_{u}}\right|$, being $\eta_{u}$ the value of $\eta$ in the turning point (loading to unloading) as follows:
\begin{equation}
\begin{array}{c}{H_{U}=H_{U 0}\left(\frac{M_{g}}{\eta_{u}}\right)^{\gamma_{u}} \text { if }\left|\frac{M_{g}}{\eta_{u}}\right|>1} \\ 
{H_{U}=H_{U 0} \quad \text { if }\left|\frac{M_{g}}{\eta_{u}}\right| \leqslant 1}\end{array}
\end{equation}



\section{Numerical Application: triaxial soil testing}
\label{sec:3}
The validation of the numerical implementation consists of the simulation of several tests, under monotonic loading conditions, of a determined soil, comparing to reference undrained consolidated triaxial compression test results. Then, the effect of velocity in consolidated triaxial compression tests with drained boundary conditions is analyzed. These results are presented following.

\subsection{Monotonic consolidated triaxial compression test: undrained boundary conditions}
\label{sec:31}
The proposed methodology has to be validated first. A triaxial test with dynamic conditions is proposed since there are several results of this kind of test in literature~\cite{PastorZC:90,Zienkiewicz99}. In Fig.~\ref{fig_Geo} a scheme of this test is presented. Because of the symmetry only one quarter of its geometry can be modeled. Thus, boundaries $\Gamma_1$ and $\Gamma_2$ have to constraint the displacement of the solid and fluid in the perpendicular direction. Boundary $\Gamma_3$ is free to move, although the fluid cannot dissipate in that boundary since there is a membrane to avoid it.

%%%%%%
\begin{figure}
\centering
\includegraphics[width=0.85\textwidth]{Figs/Geo.pdf}
\caption{Scheme of the geometry employed in the triaxial test modeling.}
\label{fig_Geo}
\end{figure}
%%%%%%

Boundary $\Gamma_4$ will change depending on the problem to be modeled. About the soil, either the displacement can be imposed or the pressure, if we want to reach a desire value of the $q$. On the other hand, the impermeability of this boundary will be given due to the drained or undrained condition of the reproduced test.

The first test to validate is an undrained monotonic triaxial test. The material employed within these tests was a sand studied by Castro (1969) that, afterwards, was calibrated for the Generalized Plasticity model~\cite{PastorZC:90,Zienkiewicz99}. The parameters that were calibrated are presented in Table~\ref{tab3}. Four different sands are studied, depending on the density state.

\begin{table}
\caption{\label{tab3} Material properties employed in the different studied problems. $\alpha_f=\alpha_g=0.45$} 
\centering
	\begin{tabular}{c|c|c|c|c|c|c|c|c}
	& 3.1 A  & 3.1 B & 3.1 C & 3.1 D & 3.2-3.3 & 4.1-1 & 4.1-2 & 4.2 \\
	\hline
        $K_{0} \left[ \text{MPa} \right]$  & 35 & 35 & 35 & 35 & 35 & 35 & 65 & 40
        \\ 
        $G_{0} \left[ \text{MPa} \right]$ & 52.5 & 52.5 & 52.5 & 52.5 & 65 & 52.5 & 30 & 16
        \\
        \(M_{f}\)  & 0.4 & 0.545 & 0.57 & 0.72 & 0.5 & 0.4 & 0.71 & 0.6
        \\
        \(M_{g}\) & 1.5 & 1.32 & 1.12 & 1.03 & 1.03 & 1.5 & 1.5 & 1.4
        \\
        \(H_{0}\) & 350 & 350 & 350 & 350 & 350  & 350 & 800 & 800
        \\
        \(\beta_{0}\) & 4.2 & 4.2 & 4.2 & 4.2 & 4.2 & 4.2 & 3.8 & 5.0
        \\
        \(\beta_{1}\) & 0.2 & 0.2 & 0.2 & 0.2 & 0.2 & 0.2 & 0.16 & 0.2
        \\
        \( \gamma\)  & - & - & - & - & - & 4 & 1 & 1
        \\
        \(H_{u 0}\) & - & - & - & - & - & 600 & 250 & 2000
        \\
        \( \gamma_{u}\)  & - & - & - & - & - & 2 & 5 & 2
        \\
	\end{tabular}
\end{table}

In this validation test boundary $\Gamma_4$ is impermeable, what makes the experiment undrained. The soil is deformed until around 8 \%, which can considered a considerable deformable range. In Fig.~\ref{fig_undrained} the obtained results are depicted. The left image shows the comparison between the theoretical results proposed by Pastor~\textit{et al.}~\cite{PastorZC:90} for the different results of the deviatoric stress against the ones obtained with the proposed methodology, observing very good agreement for the four studied soils. This agreement is also achieved in the stress paths (right column).

%%%%%%
\begin{figure}
\centering
\includegraphics[width=0.99\textwidth]{Figs/undrained.pdf}
\caption{Comparison between the results of the undrained triaxial test for the 4 different studied soils obtained by Pastor~\textit{et al.}~\cite{PastorZC:90} and with the proposed methodology: stress-strain (left) and stress path (right).}
\label{fig_undrained}
\end{figure}
%%%%%%


\subsection{Consolidation test}
\label{sec:32}
Once the behavior of the constitutive model implemented is validated, it is time to verify the performance of the Biot's formulation when the displacement of the water comes into place. Thus, an oedometer, with the geometry proposed in Fig.~\ref{fig_Geo}, is simulated in order to check the consolidation time. A permeability of 1e-6 m/s and a porosity of 0.43 are employed within this simulation. A pressure of 200 kPa is applied to the soil during 0.05 s, point that we consider the consolidation starts. The settlement is obtained from the beginning of the process. The first second of the simulation is presented in Fig.~\ref{fig_conso} for both pore pressure and settlement.
%%%%%%


\begin{figure}
\centering
\includegraphics[width=0.95\textwidth]{Figs/conso.pdf}
\caption{Consolidation results: a) Pore pressure, b) Settlement.}
\label{fig_conso}
\end{figure}
%%%%%%

Experimentally, it is demonstrated that the maximum strain rate to obtain drained conditions in a drained triaxial test can be obtained with the following equation:

\begin{equation}
v_{load}=\frac{\varepsilon_f H}{12.7 \, t_{100}}
\end{equation}\label{eq_drained}

where $\varepsilon_f H$ is a measurement of the shortening of the specimen and $t_{100}$ is the consolidation time. Since 100\% is not possible to be reached, a 95 \% of the dissipation of the pore pressure has been considered, which in Fig.~\ref{fig_conso} is observed to be around 0.48 s. Since the shortening is 0.08 mm, the velocity in which the whole specimen is able to dissipate all the excess pore water pressure has to be slower than 0.013 mm/s.

\subsection{Monotonic consolidated triaxial compression test: drained boundary conditions}
\label{sec:33}
The last monotonic test goes deeper in the drained conditions. Once the velocity to get drained conditions is calculated, a drained triaxial test with the same soil parameters of the previous section is simulated. The boundary $\Gamma_4$ of Fig.~\ref{fig_Geo} in this case allows the water outlet. Thus, the point to study if the drainage is reached if a loading rate of 0.013 mm/s is employed will be the one farther than the boundary $\Gamma_4$, \textit{i.e.} point C of Fig.~\ref{fig_Geo}.  The obtained stress path in that point is depicted in Fig.~\ref{fig_pq_drained}. We can see that, in this point, an slope 3:1, typical of drained triaxial tests, is obtained for that velocity, corroborating the hypothesis of equation~\eqref{eq_drained}.

%%%%%%
\begin{figure}
\centering
\includegraphics[width=0.75\textwidth]{Figs/pq_drained.pdf}
\caption{Effect of the loading rate on consolidated compressive triaxial stress path with drained boundary conditions.}
\label{fig_pq_drained}
\end{figure}
%%%%%%

Some faster loading velocities are studied also. The stress paths for that loading rates cover a range between the slope 3:1 and the stress path of 10 mm/s. We have seen the stress path is related to the relative density, which is function of the relationship $M_f/M_g$. This ratio, for the studied soil, is 0.49, which is similar to ratio of soil C of section~\ref{sec:31}. Thus, the stress path for undrained conditions is similar, what makes us think that, for 10 mm/s (or faster) in the middle of the specimen undrained conditions are obtained. For different locations, different paths are obtained. In Fig.~\ref{fig_drained_abc}, the stress paths of locations A, B and C are plotted. The closer is the boundary  $\Gamma_4$, the more drained is the behavior and the the stress path tends to seek the slope 3:1. However, there is not total drainage in point A. The reason is the excess of pore water pressure generated when the loading velocity is high. In Fig.~\ref{fig_drained_abc} the distribution of pore pressure along the specimen when the 1.5 \% of the strain is reached is depicted also.

%%%%%%
\begin{figure}
\centering
\includegraphics[width=1.01\textwidth]{Figs/drained_abc.pdf}
\caption{a) Stress path of the monotonic triaxial tests under drained conditions for a loading rate of 10 mm/s at three different locations, b) Pore pressure distribution at 1.5 \% of axial strain and location of different control locations.}
\label{fig_drained_abc}
\end{figure}
%%%%%%

Finally, the pore pressure generated depending on the loading rate is assessed. In Fig.~\ref{fig_pw} the pore pressure at point C when 1.5 \% of the strain is reached for different loading rates is plotted. Obviously, the dissipation is low when the loading rate increases.

%%%%%%
\begin{figure}
\centering
\includegraphics[width=0.75\textwidth]{Figs/excess_porepressure.pdf}
\caption{Pore pressure at point C when 1.5 \% of the strain is reached for different loading rates.}
\label{fig_pw}
\end{figure}
%%%%%%

%%%%%%%%
\section{Numerical Application: Cyclic behavior}
\label{sec:4}
The Generalized Plasticity model is well-known in the modeling of cyclic behavior since, explicitly, the stress state is incorporated to  normal tensor direction $ \boldsymbol{n}$ and $ \boldsymbol{n_g}$. In the proposed methodology, the trend is captured in advance by the $\theta$ angle of the strain state. The good performance of the proposed methodology is verified following with the simulated drained and undrained cyclic triaxial tests.

\subsection{Undrained conditions}
\label{subsec:41}
This test is simulated with the same Dirichlet boundary conditions that the ones employed in Section~\ref{sec:31}. Two loading conditions are studied, being those that were previously studied theoretically by Pastor~\textit{et al.}~\cite{PastorZC:90}. 

The first only lies on the compression range, studying the loading-unloading cycle. The soil parameters are presented in Table~\ref{tab3}, column 4.1-1. The results fit very well with the proposed in the studied bibliography. They can be observed in Fig.~\ref{fig_c_undrained1}.

%%%%%%
\begin{figure}
\centering
\includegraphics[width=1.05\textwidth]{Figs/ciclo_undrained_1.pdf}
\caption{Results of the cyclic triaxial tests under undrained conditions: compression.}
\label{fig_c_undrained1}
\end{figure}
%%%%%%

The problem shows that, after four cycles, the pore pressure increase Fig.~\ref{fig_c_undrainedpw} and the soil loses stability and the material liquefy induced by the cyclic loading. Thus, the strain increases dramatically and there is a reduction of the effective pressure. 

%%%%%%
\begin{figure}
\centering
\includegraphics[width=0.65\textwidth]{Figs/ciclo_undrained_pw.pdf}
\caption{Pore water pressure results of the cyclic triaxial tests under undrained conditions: compression.}
\label{fig_c_undrainedpw}
\end{figure}
%%%%%%


On the other hand, in the second test the whole compression and extension cycle is assessed, \textit{i.e.} compression loading, compression unloading, tension loading, tension unloading. A different soil from the previous test is employed, being the parameters shown in Table~\ref{tab3}, column 4.1-2. The obtained stress path  is plotted in Fig.~\ref{fig_c_undrained2}.B, which is equivalent to the obtained by Pastor~\textit{et al.}~\cite{PastorZC:90}.  This path is obtained independently to the loading rate. However, the stress-deformation curve is dependent on the loading rate, as it is observed in Fig.~\ref{fig_c_undrained2}.A. In dashed line it is plotted the curve obtained by increasing the angular frequency. \textcolor{red}{The reason can be that the excess pore water pressure generated in the final cycles,  when the phenomena is quick, cannot be stabilized and provoke a faster liquefaction of the material that enlarges the strain.}

%%%%%%
\begin{figure}
\centering
\includegraphics[width=0.98\textwidth]{Figs/ciclo_undrained_2.pdf}
\caption{Results of the cyclic triaxial tests under undrained conditions: tension-compression.}
\label{fig_c_undrained2}
\end{figure}
%%%%%%


\subsection{Drained conditions}
\label{subsec:42}
The typical behavior that is seen when drained conditions are imposed in the triaxial test shows a densification. However, the proposed material model is unable to reproduce this behavior without multiplying to $H$, Eq.~\eqref{Eq_H}, the term $H_d$, a densification measurement, which is calculated as follows:
\begin{equation}
H_{d}=\exp \left(-\gamma_{d} \; \varepsilon_{v}^{\mathrm{p}} \right)
\end{equation}
where $\varepsilon_{v}^{\mathrm{p}}$ is the cumulative volumetric plastic strain and $\gamma_{d}$ is a material parameter, which is employed in this research as 400. The higher is this parameter, the quicker the densification is obtained. This technique was proposed by Zienkiewicz and coworkers~\cite{Zienkiewicz99}.

The test consist of varying the deviatoric load between 300 kPa and 150 kPa, what gives us a variation of $\eta=p/q$, of around 0.2 and -0.2. The employed parameters are given in Table~\ref{tab3}, last column. In Fig.~\ref{fig_c_drained} the results with and without the employment of the densification parameter, which is equivalent to employ $\gamma_{d}=0$, are depicted. The goal is the reproduction of the typical behavior shown in drained sands, already presented by Bahda~\cite{bahda1997} and Zienkiewicz and coworkers~\cite{Zienkiewicz99}. 

%%%%%%
\begin{figure}
\centering
\includegraphics[width=0.95\textwidth]{Figs/ciclo_drained.pdf}
\caption{Results of the cyclic triaxial tests under drained conditions without, a), and with, b), the densification parameter $Hd$.}
\label{fig_c_drained}
\end{figure}
%%%%%%

In the first raw of the Fig.~\ref{fig_c_drained} the results without densification are presented. It can be seen how there is an increasing of the volumetric strain with the increasing of the numbers of cycles of loading. However, the increment of volumetric strain is equal in every cycle, not observing any hardening of the material, which is not the sought behavior. Thus, in the second raw, we can observe how the increment of $\varepsilon_{v}$ is reduced in every cycle, since while the $\varepsilon_{v}^{\mathrm{p}}$ increases, the value of $H$ and, therefore, the stiffness of the material, grows. After the same number of cycles, a lower value of $\varepsilon_{v}$ is obtained.


%%%%%
\section{Conclusions}
\label{sec:5}

An interesting methodology to model the dynamic behavior of saturated sands within large deformation is proposed in this paper. Several tools are collected in order to reach the sought behavior of the soil. First of all, the complete $u-w$ large strain formulation developed within an implicit time integration scheme helps us to model the dynamic behavior of saturated sands. Previously, this methodology was proposed with the Optimal Transportation Meshfree with excellent results~\cite{Navas:17c}. Finally, the Generalized Plasticity is well-known to capture properly the behavior of this soil when cyclic loads are involved. However, it was necessary to adapt this model to work in the large deformation framework, which is a big novelty of this work.


The results show excellent performance of the aforementioned tools. Different behaviors were studied in order to assess the suitability of the proposed methodology. The first one, the undrained monotonic triaxial test, help us to validate the implementation of proposed constitutive model for large deformation successfully.

Following, the limit of the drained-undrained condition is analyzed for the proposed soil. The behavior of the model under drained conditions is assessed, verifying that, when the relative motion of the water is not negligible the $u-w$ formulation presents good results. With a drained boundary condition, the effect of overcoming the theoretical velocity of a monotonic triaxial compression test was analyzed. The theoretical velocity was obtained from evaluating the consolidation of the material with a pore pressure dissipation of 95\%. This velocity allows to adequately reproduce the drained stress path. The results show that values that exceed this velocity produce generation of pore pressures as a partially drained condition. The upper limit obtained in these simulations for the analyzed material shows a limit value of 10mm/s that would be equivalent to a soil in undrained boundary conditions.

Regarding the cyclic behaviour, it can observe that the performance of the proposed method under cyclic triaxial loads is adecuate. The results show the implementation of constitutive model can reproduce the undrained cyclic strain-stress behaviour and stress path for compression cyclic loading and compression and extension cyclic loading. The evolution of pore pressure and the liquefaction phenomenon is reproduced.The increase in angular velocity produces a larger deformability of the material and an increase in pore pressure in the final cycles  prior to liquefaction. The densification of the material during a drained cyclic load is well reproduced.

The good results obtained in this research encourage us to extend this work in several directions. First of all, since only triaxial tests were carried out, more sophisticated experimental tests as well as real field cases have to be studied with the proposed methodology. On the other hand, several improvements can be made to the constitutive model. The density of the sand in section 4 was a relationship between $M_f$ and $M_g$, meanwhile recent developments of the Generalized Plasticity proposed by Manzanal \textit{et al.}~\cite{Manzanal2011,Manzanal2011a} made the densification process in the Generalized Plasticity model more elegant, being able to reproduce the behavior of the soil of the section 5.2 easily. Finally, as the methodology is able to capture dynamic behavior, makes sense that the constitutive model were able to capture different behaviors depending on the loading rate with some viscoplastic adjustment, which is something hardly explored within this model. 

\section*{Acknowledgements}
The  financial support to develop this research from the \textit{Ministerio de Ciencia e Innovaci\'on}, under Grant Number, BIA-XXXXX is greatly appreciated. The first author also acknowledges the fellowship Juan de la Cierva FJCI-2017-31544.

\appendix
%\addappheadtotoc
%\appendixpage
%\renewcommand{\theequation}{\Alph{section}.\arabic{equation}}

\clearpage
\numberwithin{equation}{section}
\section{Initial conditions in the $u-w$ formulation}
\label{ap:1}
Some of the triaxial test have, as starting points, initial stress states. In the Generalized Plasticity, it is also necessary to provide this state. Indeed, the stress of this initial point comes from a strain state. The Updated Lagrangian configuration employed within this research needs the previous Deformation Gradient and the current increment in order to situate in the current state. Thus, for the first step we need the tensor $\boldsymbol{F}$ of the initial state. Since no tangential stress takes place we can assume:
\begin{equation}
    \boldsymbol{F}_{ij}=\exp{\boldsymbol{\varepsilon}_{ij}}
\end{equation}
where $\boldsymbol{\varepsilon}_{ij}$ comes from the iterative calculation:
\begin{equation}
    \boldsymbol{\varepsilon}_{ij}=\boldsymbol{D}^{-1}_{ijkl}\:(\boldsymbol{\varepsilon}_{ij})\boldsymbol{\sigma}_{ij}(\boldsymbol{\varepsilon}_{ij})
\end{equation}

The imposition of the initial pore pressure in the $u-w$ formulation is not so straightforward as in the $u-p_w$, where it is a degree of freedom. In the proposed methodology, since it is calculated in the material points with the Eq.~\eqref{eq_uw15}, and the strain state of the soil is defined by the material model, the deformation mapping of the water has to be defined for the initial step, even if there is no initial pore pressure since an equilibrium of Eq.~\eqref{eq_uw15} has to be reached. $\boldsymbol{F}_w$ can be calculated as $\exp{\left[\text{tr}\left(\boldsymbol{\varepsilon}_{w}\right)/3\right]}$, where:
\begin{equation}
  \text{tr}\left(\boldsymbol{\varepsilon}_{w}\right) = \mbox{div} (\boldsymbol{w}) = -\frac{p_{w0}}{Q} - \mbox{div} (\boldsymbol{u})
\end{equation}


\section{Consistent Linearization}
\label{ap:2}
Following, the two main equations of the $u-w$ formulation are presented since these are the equations that are implemented in order to be solved:

\begin{itemize}
\item Linear momentum of for the solid phase
\begin{eqnarray} \label{eq_r1}
&-& \int_B \mbox{grad}(\delta\boldsymbol{u}):\boldsymbol{c}^{ep}:\mbox{grad}(\Delta\boldsymbol{u}) \, dv 
\nonumber \\
&-& \int_B \boldsymbol{ \sigma'}:\mbox{grad}^T(\delta\boldsymbol{u} )\, \mbox{grad}(\Delta\boldsymbol{u}) \, dv 
\nonumber \\
&-& \int_B 
\mbox{grad}(\, \delta\boldsymbol{u}) :\left(Q\left[
%\textcolor{red}{(1-n)}
\mbox{div}(\Delta\boldsymbol{ u})+
%\textcolor{red}{(1-\frac{1}{n})}
\mbox{div}(\Delta\boldsymbol{w}) \right] \boldsymbol{I}\right) dv
\nonumber \\
&-& \int_B 
\mbox{grad}(\, \delta\boldsymbol{u}) : p_w \, \mbox{grad}^T(\Delta\boldsymbol{u}) dv
\nonumber \\
&-& \int_B \mbox{grad}(\, \delta\boldsymbol{u}) : p_w \,\frac{1-n}{n}\mbox{div}(\Delta\boldsymbol{u})\boldsymbol{I} dv
\nonumber \\
&-& \alpha_1\int_B \delta\boldsymbol{u} \cdot \left[\rho \Delta\boldsymbol{u} + \rho_w \Delta\boldsymbol{w} + \rho_w \mbox{div}(\Delta\boldsymbol{u})\left(\boldsymbol{u}+\boldsymbol{w}\right)\right]  dv
\nonumber \\
&+& \int_B \rho_w \delta\boldsymbol{u} \cdot \boldsymbol{g} \, \mbox{div}(\Delta\boldsymbol{u})\, dv
\end{eqnarray}
%%%%%
\item Linear momentum for the fluid phase:
\begin{eqnarray} \label{eq_r2}
&-&\int_B 
\mbox{grad}(\, \delta\boldsymbol{w}) :\left(Q\left[
%\textcolor{red}{(1-n)}
\mbox{div}(\Delta\boldsymbol{ u})+
%\textcolor{red}{(1-\frac{1}{n})}
\mbox{div}(\Delta\boldsymbol{w}) \right] \boldsymbol{I}\right) dv
\nonumber \\
&-& \int_B 
\mbox{grad}(\, \delta\boldsymbol{w}) : p_w \, \mbox{grad}^T(\Delta\boldsymbol{u}) dv
\nonumber \\
&-&\int_B \mbox{grad}(\, \delta\boldsymbol{w}) : p_w \,\frac{1-n}{n}\mbox{div}(\Delta\boldsymbol{u})\boldsymbol{I} dv
\nonumber \\
&-& \alpha_4 \int_B \frac{\mu_w}{k} \delta \boldsymbol{w} \cdot \left[\Delta\boldsymbol{w} + \mbox{div}(\Delta\boldsymbol{u})\left(1-\frac{1-n}{k} \, \frac{\partial k}{\partial n}\right) \boldsymbol{w}\right] \, dv 
\nonumber\\
&-& \alpha_1\int_B\frac{\rho_w}{n} \delta\boldsymbol{w} \cdot \left[\Delta \boldsymbol{w} + \frac{2n-1}{n}\mbox{div}(\Delta\boldsymbol{u})\boldsymbol{w}\right] \, dv
\nonumber\\
&-& \alpha_1 \int_B \rho_w  \delta\boldsymbol{w} \cdot \left[\Delta \boldsymbol{u} +  \mbox{div}(\Delta\boldsymbol{u}) \boldsymbol{u} \right]\, dv
\nonumber\\
&+& \int_B \rho_w \delta\boldsymbol{w} \cdot \boldsymbol{g} \, \mbox{div}(\Delta\boldsymbol{u})\, dv
\end{eqnarray}\\
\end{itemize}



\bibliography{bib2019}

\end{document}